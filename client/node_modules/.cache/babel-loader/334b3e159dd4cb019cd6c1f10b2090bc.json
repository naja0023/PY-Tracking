{"ast":null,"code":"\"use strict\";\n\nvar __extends = this && this.__extends || function () {\n  var extendStatics = function (d, b) {\n    extendStatics = Object.setPrototypeOf || {\n      __proto__: []\n    } instanceof Array && function (d, b) {\n      d.__proto__ = b;\n    } || function (d, b) {\n      for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p];\n    };\n\n    return extendStatics(d, b);\n  };\n\n  return function (d, b) {\n    extendStatics(d, b);\n\n    function __() {\n      this.constructor = d;\n    }\n\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n  };\n}();\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar React = require(\"react\");\n\nvar isScrollable_1 = require(\"../isScrollable\");\n\nvar PullToRefresh =\n/** @class */\nfunction (_super) {\n  __extends(PullToRefresh, _super);\n\n  function PullToRefresh(props) {\n    var _this = _super.call(this, props) || this;\n\n    _this.dragging = false;\n    _this.startY = 0;\n    _this.currentY = 0;\n    _this.state = {\n      pullToRefreshThresholdBreached: false,\n      maxPullDownDistance: 0,\n      onRefreshing: false\n    };\n    _this.containerRef = _this.containerRef.bind(_this);\n    _this.pullDownRef = _this.pullDownRef.bind(_this);\n    _this.onTouchStart = _this.onTouchStart.bind(_this);\n    _this.onTouchMove = _this.onTouchMove.bind(_this);\n    _this.onEnd = _this.onEnd.bind(_this);\n    return _this;\n  }\n\n  PullToRefresh.prototype.containerRef = function (container) {\n    this.container = container;\n  };\n\n  PullToRefresh.prototype.pullDownRef = function (pullDown) {\n    this.pullDown = pullDown;\n    var maxPullDownDistance = this.pullDown && this.pullDown.firstChild && this.pullDown.firstChild[\"getBoundingClientRect\"] ? this.pullDown.firstChild[\"getBoundingClientRect\"]().height : 0;\n    this.setState({\n      maxPullDownDistance: maxPullDownDistance\n    });\n  };\n\n  PullToRefresh.prototype.componentDidMount = function () {\n    if (!this.container) {\n      return;\n    }\n\n    this.container.addEventListener(\"touchstart\", this.onTouchStart);\n    this.container.addEventListener(\"touchmove\", this.onTouchMove);\n    this.container.addEventListener(\"touchend\", this.onEnd);\n    this.container.addEventListener(\"mousedown\", this.onTouchStart);\n    this.container.addEventListener(\"mousemove\", this.onTouchMove);\n    this.container.addEventListener(\"mouseup\", this.onEnd);\n  };\n\n  PullToRefresh.prototype.componentWillUnmount = function () {\n    if (!this.container) {\n      return;\n    }\n\n    this.container.removeEventListener(\"touchstart\", this.onTouchStart);\n    this.container.removeEventListener(\"touchmove\", this.onTouchMove);\n    this.container.removeEventListener(\"touchend\", this.onEnd);\n    this.container.removeEventListener(\"mousedown\", this.onTouchStart);\n    this.container.removeEventListener(\"mousemove\", this.onTouchMove);\n    this.container.removeEventListener(\"mouseup\", this.onEnd);\n  };\n\n  PullToRefresh.prototype.onTouchStart = function (e) {\n    var _a = this.props.triggerHeight,\n        triggerHeight = _a === void 0 ? 40 : _a;\n    this.startY = e[\"pageY\"] || e.touches[0].pageY;\n    this.currentY = this.startY;\n\n    if (triggerHeight === \"auto\") {\n      var target = e.target;\n      var container = this.container;\n\n      if (!container) {\n        return;\n      } // an element we're touching can be scrolled up, so gesture is going to be a scroll gesture\n\n\n      if (e.type === \"touchstart\" && isScrollable_1.isTreeScrollable(target, isScrollable_1.DIRECTION.up)) {\n        return;\n      } // even though we're not scrolling, the pull-to-refresh isn't visible to the user so cancel\n\n\n      if (container.getBoundingClientRect().top < 0) {\n        return;\n      }\n    } else {\n      var top_1 = this.container.getBoundingClientRect().top || this.container.getBoundingClientRect().y || 0;\n\n      if (this.startY - top_1 > triggerHeight) {\n        return;\n      }\n    }\n\n    this.dragging = true;\n    this.container.style.transition = \"transform 0.2s cubic-bezier(0,0,0.31,1)\";\n    this.pullDown.style.transition = \"transform 0.2s cubic-bezier(0,0,0.31,1)\";\n  };\n\n  PullToRefresh.prototype.onTouchMove = function (e) {\n    if (!this.dragging) {\n      return;\n    }\n\n    this.currentY = e[\"pageY\"] || e.touches[0].pageY;\n\n    if (this.currentY < this.startY) {\n      return;\n    }\n\n    e.preventDefault();\n\n    if (this.currentY - this.startY >= this.props.pullDownThreshold) {\n      this.setState({\n        pullToRefreshThresholdBreached: true\n      });\n    }\n\n    if (this.currentY - this.startY > this.state.maxPullDownDistance) {\n      return;\n    }\n\n    this.container.style.overflow = \"visible\";\n    this.container.style.transform = \"translate(0px, \" + (this.currentY - this.startY) + \"px)\";\n    this.pullDown.style.visibility = \"visible\";\n  };\n\n  PullToRefresh.prototype.onEnd = function () {\n    var _this = this;\n\n    this.dragging = false;\n    this.startY = 0;\n    this.currentY = 0;\n\n    if (!this.state.pullToRefreshThresholdBreached) {\n      this.pullDown.style.visibility = this.props.startInvisible ? \"hidden\" : \"visible\";\n      this.initContainer();\n      return;\n    }\n\n    this.container.style.overflow = \"visible\";\n    this.container.style.transform = \"translate(0px, \" + this.props.pullDownThreshold + \"px)\";\n    this.setState({\n      onRefreshing: true\n    }, function () {\n      _this.props.onRefresh().then(function () {\n        _this.initContainer();\n\n        setTimeout(function () {\n          _this.setState({\n            onRefreshing: false,\n            pullToRefreshThresholdBreached: false\n          });\n        }, 200);\n      });\n    });\n  };\n\n  PullToRefresh.prototype.initContainer = function () {\n    var _this = this;\n\n    requestAnimationFrame(function () {\n      if (_this.container) {\n        _this.container.style.overflow = \"auto\";\n        _this.container.style.transform = \"none\";\n      }\n    });\n  };\n\n  PullToRefresh.prototype.renderPullDownContent = function () {\n    var _a = this.props,\n        releaseContent = _a.releaseContent,\n        pullDownContent = _a.pullDownContent,\n        refreshContent = _a.refreshContent,\n        startInvisible = _a.startInvisible;\n    var _b = this.state,\n        onRefreshing = _b.onRefreshing,\n        pullToRefreshThresholdBreached = _b.pullToRefreshThresholdBreached;\n    var content = onRefreshing ? refreshContent : pullToRefreshThresholdBreached ? releaseContent : pullDownContent;\n    var contentStyle = {\n      position: \"absolute\",\n      overflow: \"hidden\",\n      left: 0,\n      right: 0,\n      top: 0,\n      visibility: startInvisible ? \"hidden\" : \"visible\"\n    };\n    return React.createElement(\"div\", {\n      style: contentStyle,\n      ref: this.pullDownRef\n    }, content);\n  };\n\n  PullToRefresh.prototype.render = function () {\n    var backgroundColor = this.props.backgroundColor;\n    var containerStyle = {\n      height: \"auto\",\n      overflow: \"hidden\",\n      WebkitOverflowScrolling: \"touch\",\n      position: \"relative\",\n      zIndex: 1\n    };\n\n    if (backgroundColor) {\n      containerStyle.backgroundColor = backgroundColor;\n    }\n\n    return React.createElement(\"div\", {\n      style: containerStyle\n    }, this.renderPullDownContent(), React.createElement(\"div\", {\n      ref: this.containerRef,\n      style: containerStyle\n    }, this.props.children));\n  };\n\n  return PullToRefresh;\n}(React.Component);\n\nexports.PullToRefresh = PullToRefresh;","map":{"version":3,"sources":["../../../src/components/PullToRefresh.tsx"],"names":[],"mappings":"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","sourceRoot":"","sourcesContent":["\"use strict\";\nvar __extends = (this && this.__extends) || (function () {\n    var extendStatics = function (d, b) {\n        extendStatics = Object.setPrototypeOf ||\n            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\n            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\n        return extendStatics(d, b);\n    }\n    return function (d, b) {\n        extendStatics(d, b);\n        function __() { this.constructor = d; }\n        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\n    };\n})();\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar React = require(\"react\");\nvar isScrollable_1 = require(\"../isScrollable\");\nvar PullToRefresh = /** @class */ (function (_super) {\n    __extends(PullToRefresh, _super);\n    function PullToRefresh(props) {\n        var _this = _super.call(this, props) || this;\n        _this.dragging = false;\n        _this.startY = 0;\n        _this.currentY = 0;\n        _this.state = {\n            pullToRefreshThresholdBreached: false,\n            maxPullDownDistance: 0,\n            onRefreshing: false,\n        };\n        _this.containerRef = _this.containerRef.bind(_this);\n        _this.pullDownRef = _this.pullDownRef.bind(_this);\n        _this.onTouchStart = _this.onTouchStart.bind(_this);\n        _this.onTouchMove = _this.onTouchMove.bind(_this);\n        _this.onEnd = _this.onEnd.bind(_this);\n        return _this;\n    }\n    PullToRefresh.prototype.containerRef = function (container) {\n        this.container = container;\n    };\n    PullToRefresh.prototype.pullDownRef = function (pullDown) {\n        this.pullDown = pullDown;\n        var maxPullDownDistance = this.pullDown && this.pullDown.firstChild && this.pullDown.firstChild[\"getBoundingClientRect\"]\n            ? this.pullDown.firstChild[\"getBoundingClientRect\"]().height : 0;\n        this.setState({ maxPullDownDistance: maxPullDownDistance });\n    };\n    PullToRefresh.prototype.componentDidMount = function () {\n        if (!this.container) {\n            return;\n        }\n        this.container.addEventListener(\"touchstart\", this.onTouchStart);\n        this.container.addEventListener(\"touchmove\", this.onTouchMove);\n        this.container.addEventListener(\"touchend\", this.onEnd);\n        this.container.addEventListener(\"mousedown\", this.onTouchStart);\n        this.container.addEventListener(\"mousemove\", this.onTouchMove);\n        this.container.addEventListener(\"mouseup\", this.onEnd);\n    };\n    PullToRefresh.prototype.componentWillUnmount = function () {\n        if (!this.container) {\n            return;\n        }\n        this.container.removeEventListener(\"touchstart\", this.onTouchStart);\n        this.container.removeEventListener(\"touchmove\", this.onTouchMove);\n        this.container.removeEventListener(\"touchend\", this.onEnd);\n        this.container.removeEventListener(\"mousedown\", this.onTouchStart);\n        this.container.removeEventListener(\"mousemove\", this.onTouchMove);\n        this.container.removeEventListener(\"mouseup\", this.onEnd);\n    };\n    PullToRefresh.prototype.onTouchStart = function (e) {\n        var _a = this.props.triggerHeight, triggerHeight = _a === void 0 ? 40 : _a;\n        this.startY = e[\"pageY\"] || e.touches[0].pageY;\n        this.currentY = this.startY;\n        if (triggerHeight === \"auto\") {\n            var target = e.target;\n            var container = this.container;\n            if (!container) {\n                return;\n            }\n            // an element we're touching can be scrolled up, so gesture is going to be a scroll gesture\n            if (e.type === \"touchstart\" && isScrollable_1.isTreeScrollable(target, isScrollable_1.DIRECTION.up)) {\n                return;\n            }\n            // even though we're not scrolling, the pull-to-refresh isn't visible to the user so cancel\n            if (container.getBoundingClientRect().top < 0) {\n                return;\n            }\n        }\n        else {\n            var top_1 = this.container.getBoundingClientRect().top || this.container.getBoundingClientRect().y || 0;\n            if (this.startY - top_1 > triggerHeight) {\n                return;\n            }\n        }\n        this.dragging = true;\n        this.container.style.transition = \"transform 0.2s cubic-bezier(0,0,0.31,1)\";\n        this.pullDown.style.transition = \"transform 0.2s cubic-bezier(0,0,0.31,1)\";\n    };\n    PullToRefresh.prototype.onTouchMove = function (e) {\n        if (!this.dragging) {\n            return;\n        }\n        this.currentY = e[\"pageY\"] || e.touches[0].pageY;\n        if (this.currentY < this.startY) {\n            return;\n        }\n        e.preventDefault();\n        if ((this.currentY - this.startY) >= this.props.pullDownThreshold) {\n            this.setState({\n                pullToRefreshThresholdBreached: true,\n            });\n        }\n        if (this.currentY - this.startY > this.state.maxPullDownDistance) {\n            return;\n        }\n        this.container.style.overflow = \"visible\";\n        this.container.style.transform = \"translate(0px, \" + (this.currentY - this.startY) + \"px)\";\n        this.pullDown.style.visibility = \"visible\";\n    };\n    PullToRefresh.prototype.onEnd = function () {\n        var _this = this;\n        this.dragging = false;\n        this.startY = 0;\n        this.currentY = 0;\n        if (!this.state.pullToRefreshThresholdBreached) {\n            this.pullDown.style.visibility = this.props.startInvisible ? \"hidden\" : \"visible\";\n            this.initContainer();\n            return;\n        }\n        this.container.style.overflow = \"visible\";\n        this.container.style.transform = \"translate(0px, \" + this.props.pullDownThreshold + \"px)\";\n        this.setState({\n            onRefreshing: true,\n        }, function () {\n            _this.props.onRefresh().then(function () {\n                _this.initContainer();\n                setTimeout(function () {\n                    _this.setState({\n                        onRefreshing: false,\n                        pullToRefreshThresholdBreached: false,\n                    });\n                }, 200);\n            });\n        });\n    };\n    PullToRefresh.prototype.initContainer = function () {\n        var _this = this;\n        requestAnimationFrame(function () {\n            if (_this.container) {\n                _this.container.style.overflow = \"auto\";\n                _this.container.style.transform = \"none\";\n            }\n        });\n    };\n    PullToRefresh.prototype.renderPullDownContent = function () {\n        var _a = this.props, releaseContent = _a.releaseContent, pullDownContent = _a.pullDownContent, refreshContent = _a.refreshContent, startInvisible = _a.startInvisible;\n        var _b = this.state, onRefreshing = _b.onRefreshing, pullToRefreshThresholdBreached = _b.pullToRefreshThresholdBreached;\n        var content = onRefreshing ? refreshContent : pullToRefreshThresholdBreached ? releaseContent : pullDownContent;\n        var contentStyle = {\n            position: \"absolute\",\n            overflow: \"hidden\",\n            left: 0,\n            right: 0,\n            top: 0,\n            visibility: startInvisible ? \"hidden\" : \"visible\",\n        };\n        return (React.createElement(\"div\", { style: contentStyle, ref: this.pullDownRef }, content));\n    };\n    PullToRefresh.prototype.render = function () {\n        var backgroundColor = this.props.backgroundColor;\n        var containerStyle = {\n            height: \"auto\",\n            overflow: \"hidden\",\n            WebkitOverflowScrolling: \"touch\",\n            position: \"relative\",\n            zIndex: 1,\n        };\n        if (backgroundColor) {\n            containerStyle.backgroundColor = backgroundColor;\n        }\n        return (React.createElement(\"div\", { style: containerStyle },\n            this.renderPullDownContent(),\n            React.createElement(\"div\", { ref: this.containerRef, style: containerStyle }, this.props.children)));\n    };\n    return PullToRefresh;\n}(React.Component));\nexports.PullToRefresh = PullToRefresh;\n//# sourceMappingURL=PullToRefresh.js.map"]},"metadata":{},"sourceType":"script"}